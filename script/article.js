"use strict";function getScrollY(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}function returnTop(){var t=getScrollY();0<t&&$("html,body").stop().animate({scrollTop:0},100*Math.log(t))}function jumpto(t){window.top.window.location=t}function initTidSearch(t){if(!window.tidSearch){window.tidSearch=new TidSearch({input:t,output:"#subform",json:"/search.json",template:'<li class="excerpt-container"><h2><a href="{url}" target="_blank">{title}</a></h2><p class="date"><i class="fa fa-calendar"></i>&nbsp;{date}</p><div style="clear: both"></div><p class="excerpt">{content}</p></li>',templateMiddleware:function(t,o){return"content"===o?t.content.slice(0,100)+"……":t[o]},noResult:"没有找到对应的关键词。"})}return tidSearch.loaded}function onSchSubmit(){initTidSearch(".sch").then(function(){var t=$(".sch").val();""!=t?(window.tidSearch.search(t),$("#subform").slideDown()):$("#subform").slideUp()})}function rmCookie(t){document.cookie="".concat(t,"=; expires=Thu, 01 Jan 1970 00:00:00 GMT")}function bgcolor(){try{var t=document.createElement("canvas").getContext("2d"),o=document.getElementById("background");t.drawImage(o,0,0);for(var n=t.getImageData(0,0,50,o.clientWidth).data,e=0,a=0,i=0,c=0,r=function(t,o,n){var e=Math.max(t,o,n),a=Math.min(t,o,n),i=e+a>>1;return 128<i&&i<230&&.2<(i<128?(e-a)/(e+a):(e-a)/(512-e-a))};c<10;){for(var s=c=0;s<n.length;s+=4){var d=n[s],l=n[s+1],u=n[s+2];r(d,l,u)&&(c+=1,e+=d,a+=l,i+=u)}r=function(){return!0}}return(e=e/c|0)*(a=a/c|0)*(i=i/c|0)==0?"rgba(187,152,178,":"rgba(".concat(e,",").concat(a,",").concat(i,",")}catch(t){return console.log(t),"rgba(187,152,178,"}}function getBackgroundColor(){var t=function(t){return"rgba(0,0,0,".concat(t,")")},o=document.cookie.split(";").map(function(t){return t.split("=")}).find(function(t){return"bcolor"==t[0]});if(o)t=function(t){return o[1]+t+")"};else{var n=bgcolor(),e=new Date;e.setDate(e.getDate()+1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),document.cookie="bcolor=".concat(n,"; expires=").concat(e.toUTCString()),t=function(t){return n+t+")"}}return t}800<=window.screen.width?$(function(){var n=getBackgroundColor();$("#tagform div").css("background-color",n(1)),$("#slidebar").css("border-color",n(1));var t=!0,o=$("#slidebar"),e=$("#nav"),a=$("#main");o.slideUp(0),$("#menu").click(function(){t||50<getScrollY()?e.stop().animate({backgroundColor:n(1)},500):e.stop().animate({backgroundColor:n(0)},500),t?(a.stop().animate({marginLeft:"30%"},500),o.stop().animate({opacity:1},200).slideDown(300)):(a.stop().animate({marginLeft:"20%"},500),o.stop().animate({opacity:0},200).slideUp(300)),t=!t});function i(){t=!0,50<getScrollY()?e.stop().animate({backgroundColor:n(1)},500):e.stop().animate({backgroundColor:n(0)},500),o.stop().animate({opacity:0},200),o.slideUp(300),a.stop().animate({marginLeft:"20%"},500),$("#subform").slideUp()}a.click(i),$("body").click(function(t){(t.target||t.srcElement)==document.body&&i()}),$("#subform").slideUp(0),$(".schbtn").click(onSchSubmit),$(window).scroll(function(){!t||50<getScrollY()?e.stop().animate({backgroundColor:n(1)},300):e.stop().animate({backgroundColor:n(0)},300)}).scroll();var c=$("#tagform");$("li[data-index]").mouseenter(function(){var t=$(this).attr("data-index"),o=Number(t)-Number($("li[data-index]").first().attr("data-index"));$("div[data-index="+t+"]").stop().css("top",(52*o+60).toString()+"px").show(),c.stop().show(),$(this).css("background-color",n(.8))}),$("div[data-index]").mouseenter(function(){$(this).stop().show(),c.stop().show(),$("li[data-index="+$(this).attr("data-index")+"]").css("background-color",n(.8))}),$("li[data-index]").mouseleave(function(){$("div[data-index="+$(this).attr("data-index")+"]").hide(1),c.hide(1),$(this).css("background-color",n(0))}),$("div[data-index]").mouseleave(function(){$(this).hide(1),c.hide(1),$("li[data-index="+$(this).attr("data-index")+"]").css("background-color",n(0))})}):$(function(){var t=getBackgroundColor()(1);$("#nav").css("background-color",t),$("ul.taglist li, #tagform li").css("border-color",t);var o=document.getElementById("schbtn");o.parentNode.removeChild(o),document.getElementById("nav").appendChild(o),$(o).click(function(){jumpto("/search")}),$(window).resize(function(){var t="".concat(window.screen.height/10,"px"),o="".concat(window.screen.height/15,"px");$("#nav").css({height:t,"font-size":o}),$("#slidebar, #tagform").css("top",t)}).resize();var n=!0,e=$("#mask"),a=$("#tagform"),i=$("#slidebar");function c(t){$("div[data-index="+$(t).attr("data-index")+"]").hide(1),$(t).css("background-color","white")}var r=$("li[data-index]").first()[0];$("#menu").click(function(){n?(e.css({"z-index":"10",opacity:"1","mix-blend-mode":"darken"}),e.stop().animate({backgroundColor:"rgb(128,128,128,0.8)"}),a.stop().show().css({left:"-20%",right:"40%",opacity:"0"}),$(r).click(),i.stop().animate({left:"0",right:"60%"},150,function(){a.animate({left:"40%",right:"0",opacity:"1"},150)})):(e.css({"z-index":"-2",opacity:"1","mix-blend-mode":"darken"}),e.stop().animate({backgroundColor:"rgb(128,128,128,0)"}),a.stop().css({left:"40%",right:"0",opacity:"1"}),i.stop(),a.animate({left:"-20%",right:"60%",opacity:0},150,function(){i.animate({left:"-40%",right:"100%"},150,function(){c(r)}),a.hide()})),n=!n}),$("li[data-index]").click(function(){r!=this&&c(r),r=this,$("div[data-index="+$(this).attr("data-index")+"]").stop().show(),$(this).css("background-color",t)})}),$(function(){$(window).resize(function(){$("#main").css("min-height",document.documentElement.clientHeight-120+"px")}).resize(),$("a.reversefootnote").css("text-decoration","none").attr("class","fa fa-reply").empty()});